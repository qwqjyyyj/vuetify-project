import{S as E,ae as I,ad as R,G as q,c as V,U as z,Y as l,$ as g,X as s,L as e,aw as h,ai as u,W as y,_ as A,O as C,af as i,ag as b,V as D,aj as P,am as U,R as j}from"./index-BEDy4TUC.js";import{V as p,a as F,b as w}from"./route-block-BAhhJMUA.js";import{V as x}from"./VDivider-ClWxI0hI.js";import{V as G,a as O}from"./VList-CGXOrgeM.js";import{V as T}from"./VContainer-DAD35DGj.js";const W={class:"tet-center"},X={__name:"cart",setup(Y){const{apiAuth:d}=U(),m=E(),B=I(),_=R(),{t:v}=j,n=q([]),f=async()=>{try{const{data:a}=await d.get("/user/cart");n.value=a.result}catch(a){console.log(a)}};f();const $=V(()=>n.value.reduce((a,o)=>a+o.product.price*o.quantity,0)),L=V(()=>n.value.length>0&&n.value.every(a=>a.product.sell)),k=async(a,o)=>{var r,t;try{const{data:c}=await d.patch("/user/cart",{product:a,quantity:o});m.cart=c.result,f()}catch(c){console.log(c),_({text:v("api."+(((t=(r=c==null?void 0:c.reasponse)==null?void 0:r.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"red"}})}},N=async()=>{var a,o;try{await d.post("/order"),m.cart=0,B.push("/order")}catch(r){console.log(r),_({text:v("api."+(((o=(a=r==null?void 0:r.reasponse)==null?void 0:a.data)==null?void 0:o.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(a,o)=>{const r=z("v-avarta");return l(),g(T,null,{default:s(()=>[e(F,null,{default:s(()=>[e(p,{cols:"12"},{default:s(()=>[h("h1",W,u(a.$t("nav.cart")),1)]),_:1}),e(x),e(p,{cols:"12"},{default:s(()=>[e(G,{lines:"two"},{default:s(()=>[(l(!0),y(C,null,A(n.value,(t,c)=>(l(),y(C,{key:t._id},[e(O,{title:t.product.name,subtitle:t.product.price,"active-class":"bg-red",active:!t.product.sell},{prepend:s(()=>[e(r,{rounded:"0"},{default:s(()=>[e(D,{src:t.prodcut.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[e(i,{color:"red",icon:"mdi-minus",size:"small",class:"mr-2",onClick:S=>k(t.product._id,-1)},null,8,["onClick"]),b(" "+u(t.quantity)+" ",1),e(i,{color:"green",icon:"mdi-plus",size:"small",class:"ml-2",onClick:S=>k(t.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),c<n.value.length-1?(l(),g(x,{key:0})):P("",!0)],64))),128))]),_:1})]),_:1}),e(p,{cols:"12",class:"text-center"},{default:s(()=>[h("p",null,u($.value),1),e(i,{color:"primary",disabled:!L.value,onClick:N},{default:s(()=>[b(u(a.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})}}};typeof w=="function"&&w(X);export{X as default};
